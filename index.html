<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>

<body>

    <script>
        var char;
        var move_speed = 250
        var knives = new Set()
        var knife_count = 10

        var config = {
            type: Phaser.AUTO,
            width: 1000,
            height: 1000,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 }
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        var game = new Phaser.Game(config);

        function preload() {
            this.load.image('knife', 'assets/knife.png');
            this.load.image('chowder', 'assets/chowder.png');
        }

        function spawnKnives() {
            for (let i =0; i <= knife_count; i++) {
                knife = this.physics.add.image(char.x, char.y, 'knife');
                knife.setScale(.1)
                knife.setVelocityX(Math.random() * move_speed)
                knife.setVelocityY(Math.random() * move_speed)
                knives.add(knife)
            }
        }

        function create() {
            char = this.physics.add.image(400, 300, 'chowder');
            char.setCollideWorldBounds(true);
            keys = this.input.keyboard.addKeys("W,A,S,D");
            
            this.time.addEvent({
                delay: 1000,             
                callback: spawnKnives,
                callbackScope: this,
                loop: true
            });

        }

        function update() {
            if (keys.A.isDown) {
                char.setVelocityX(-move_speed)
            } else if (keys.D.isDown) {
                char.setVelocityX(move_speed)
            } else {
                char.setVelocityX(0) 
            }

            if (keys.W.isDown) {
                char.setVelocityY(-move_speed) 
            } else if (keys.S.isDown) {
                char.setVelocityY(move_speed) 
            } else {
                char.setVelocityY(0) 
            }
        }
    </script>

</body>

</html>